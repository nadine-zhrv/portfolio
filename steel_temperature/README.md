# Определение температуры стали

## Описание проекта

Чтобы оптимизировать производственные расходы, металлургический комбинат решил уменьшить потребление электроэнергии на этапе обработки стали. Предстоит построить модель, которая предскажет температуру стали.

Целевая метрика: MAE (<=6.8)

## Навыки и инстурменты

- Python
- Pandas
- Numpy
- Matplotlib
- Seaborn
- Sklearn
- LinearRegression
- RandomForestRegressor
- CatBoostRegressor
- LGBMRegressor

## Общий вывод

Для исследования и обучения модели были предоставлены 7 файлов с данными об электродах, сыпучих и проволочных материалов, о продувке газом и температуры. Предстояла задача обучить модель предсказывать температуру стали, чтобы таким образом снизить протребление элетроэнергии на этапе обработки.

Было сделано следующее:
* Проведен исследовательский анализ данных всех файлов. Найдены различные артефакты: пропуски и аномалии. На основании этой информации был составлен план решения задачи.

* Сделали предобработку данных. В данных об электродах и замерах температуры сгруппировали записи по номерам партии, так как в этих файлах было по нескольку строк на партию, что соотвествовало разным итерациям обработки. Также в этих файлах были замечаны аномальные значения реактивной мощности (единственное отрицательное значение) и температуры (по условию она не может быть ниже 1500), они были устранены. В данных об объеме сыпучих и проволочных материалов была большая доля пропусков, которые заменили на нули. Те же данные, но о дате и времени решено было не использовать.

* Для обучения модели создали новые признаки: полную мощность, время нагрева и время между замерами температуры. Полную мощность посчитали на основании данных об активной и реактивной мощности по формуле. Из данных о температуре оставили только первую и последнюю записи за партию. Последняя температуры - целевой признак. Пришлось удалить ключи от 2500, так как они оказались неинформативны.

* Создали новую таблицу с признакми. В нее вошли: полная мощность, время нагрева, первая и последняя температуры, время между замерами, газ, все признаки сыпучих материалов, кроме 9, и все признаки проволочных материалов, кроме 5. Признаки были проверены на мультиколлинеарность.

* Для сравнения были обучены модель Линейной регрессии, Случайного леса, CatBoost и LGBM. Использовали кросс-валидацию, применив алгорим автоматического поиска параметров. Посчитали целевую метрику MAE. Затем лучшую модель проверили на тестовой выборке.

Лучшая модель: CatBoost 
- Параметры модели: learning_rate=0.1, max_depth=5 и n_estimators=200
- MAE на обучающей выборке 5.86, на тестовой - 5.87
- Наиболее важный признак при обучении модели - время нагрева и первая температура.

